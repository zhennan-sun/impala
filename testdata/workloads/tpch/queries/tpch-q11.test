====
---- QUERY: TPCH-Q11
# Q11 - Important Stock Identification
# Modifications: Added round() calls, query was rewritten to not have a subquery in the
# having clause
select
  *
from (
  select
    ps_partkey,
    round(sum(ps_supplycost * ps_availqty), 1) as value
  from
    partsupp,
    supplier,
    nation
  where
    ps_suppkey = s_suppkey
    and s_nationkey = n_nationkey
    and n_name = 'GERMANY'
  group by
    ps_partkey
) as inner_query
where
  value > (
    select
      sum(ps_supplycost * ps_availqty) * 0.0001
    from
      partsupp,
      supplier,
      nation
    where
      ps_suppkey = s_suppkey
      and s_nationkey = n_nationkey
      and n_name = 'GERMANY'
  )
order by
  value desc
---- RESULTS
129760,17538456.9
166726,16503353.9
191287,16474802
161758,16101755.5
34452,15983844.7
139035,15907078.3
9403,15451755.6
154358,15212937.9
38823,15064802.9
85606,15053957.2
33354,14408297.4
154747,14407580.7
82865,14235489.8
76094,14094247
222,13937777.7
121271,13908336
55221,13716120.5
22819,13666434.3
76281,13646853.7
85298,13581154.9
85158,13554904
139684,13535538.7
31034,13498025.3
87305,13482847
10181,13445148.8
62323,13411824.3
26489,13377256.4
96493,13339057.8
56548,13329015
55576,13306843.4
159751,13306614.5
92406,13287414.5
182636,13223726.7
199969,13135288.2
62865,13001926.9
7284,12945298.2
197867,12944510.5
11562,12931575.5
75165,12916918.1
97175,12911283.5
140840,12896562.2
65241,12890600.5
166120,12876927.2
9035,12863828.7
144616,12853549.3
176723,12832309.7
170884,12792136.6
29790,12723300.3
95213,12555483.7
183873,12550533.1
171235,12476538.3
21533,12437821.3
17290,12432159.5
156397,12260623.5
122611,12222813
139155,12220319.3
146316,12215800.6
171381,12199734.5
198633,12078227
167417,12046637.6
59512,12043468.8
31688,12034893.6
159586,12001505.8
8993,11963814.3
120302,11857707.5
43536,11779340.5
9552,11776909.2
86223,11772205.1
53776,11758669.7
131285,11616953.7
91628,11611114.8
169644,11567959.7
182299,11567462.1
33107,11453818.8
104184,11436657.4
67027,11419127.1
176869,11371451.7
30885,11369674.8
54420,11345076.9
72240,11313951
178708,11294635.2
81298,11273686.1
158324,11243442.7
117095,11242535.2
176793,11237733.4
86091,11177793.8
116033,11145434.4
129058,11119112.2
193714,11104706.4
117195,11077218
49851,11043701.8
19791,11030662.6
75800,11012401.6
161562,10996371.7
10119,10980015.8
39185,10970042.6
47223,10950022.1
175594,10942923.1
111295,10893675.6
155446,10852764.6
156391,10839810.4
40884,10837234.2
141288,10837130.2
152388,10830977.8
33449,10830858.7
149035,10826130
162620,10814275.7
118324,10791788.1
38932,10777541.8
121294,10764225.2
48721,10762582.5
63342,10740132.6
5614,10724668.8
62266,10711143.1
100202,10696675.6
197741,10688560.7
169178,10648522.8
5271,10639392.7
34499,10584177.1
71108,10569117.6
137132,10539880.5
78451,10524873.2
150827,10503810.5
107237,10488030.8
101727,10473558.1
58708,10466280.4
89768,10465477.2
146493,10444291.6
55424,10444006.5
16560,10425574.7
133114,10415097.9
195810,10413625.2
76673,10391977.2
97305,10390890.6
134210,10387210
188536,10386529.9
122255,10335760.3
2682,10312966.1
43814,10303086.6
34767,10290405.2
165584,10273705.9
2231,10270415.6
111259,10263256.6
195578,10239795.8
21093,10217531.3
29856,10216932.5
133686,10213345.8
87745,10185509.4
135153,10179379.7
11773,10167410.8
76316,10165151.7
123076,10161225.8
91894,10130462.2
39741,10128387.5
111753,10119781
142729,10104748.9
116775,10097750.4
102589,10034784.4
186268,10012181.6
44545,10000286.5
23307,9966577.5
124281,9930018.9
69604,9925730.6
21971,9908982
58148,9895894.4
16532,9886529.9
159180,9883744.4
74733,9877582.9
35173,9858275.9
7116,9856881
124620,9838589.1
122108,9829949.4
67200,9828690.699999999
164775,9821424.4
9039,9816447.699999999
14912,9803102.199999999
190906,9791315.699999999
130398,9781674.300000001
119310,9776927.199999999
10132,9770930.800000001
107211,9757586.300000001
113958,9757065.5
37009,9748362.699999999
66746,9743528.800000001
134486,9731922
15945,9731096.5
55307,9717745.800000001
56362,9714922.800000001
57726,9711792.1
57256,9708621
112292,9701653.1
87514,9699492.5
174206,9680562
72865,9679043.300000001
114357,9671017.4
112807,9665019.199999999
115203,9661018.699999999
177454,9658906.4
161275,9634313.699999999
61893,9617095.4
122219,9604888.199999999
183427,9601362.6
59158,9599706
61931,9584919
5532,9579964.1
20158,9576714.4
167199,9557413.1
38869,9550279.5
86949,9541943.699999999
198544,9538613.9
193762,9538238.9
108807,9536247.199999999
168324,9535648
115588,9532195
141372,9529702.1
175120,9526068.699999999
163851,9522808.800000001
160954,9520359.5
117757,9517882.800000001
52594,9508325.800000001
60960,9498843.1
70272,9495775.6
44050,9495515.4
152213,9494757
121203,9492601.300000001
70114,9491012.300000001
167588,9484741.1
136455,9476241.800000001
4357,9464355.6
6786,9463632.6
61345,9455336.699999999
160826,9446754.800000001
71275,9440138.4
77746,9439118.4
91289,9437472
56723,9435102.199999999
86647,9434604.199999999
131234,9432120
198129,9427651.4
165530,9426193.699999999
69233,9425053.9
6243,9423304.699999999
90110,9420422.699999999
191980,9419368.4
38461,9419316.1
167873,9419024.5
159373,9416950.1
128707,9413428.5
45267,9410863.800000001
48460,9409793.9
197672,9406887.699999999
60884,9403442.4
15209,9403245.300000001
138049,9401262.1
199286,9391770.699999999
19629,9391236.4
134019,9390615.199999999
169475,9387639.6
165918,9379510.4
135602,9374251.5
162323,9367566.5
96277,9360850.699999999
98336,9359671.300000001
119781,9356395.699999999
34440,9355365
57362,9355180.1
167236,9352973.800000001
38463,9347530.9
86749,9346826.4
170007,9345699.9
193087,9343744
150383,9332576.800000001
60932,9329582
128420,9328206.4
162145,9327722.9
55686,9320304.4
163080,9304917
160583,9303515.9
118153,9298606.6
152634,9282184.6
84731,9276586.9
119989,9273814.199999999
114584,9269698.699999999
131817,9268570.1
29068,9256583.9
44116,9255922
115818,9253311.9
103388,9239218.1
186118,9236209.1
155809,9235410.800000001
147003,9234848
27769,9232511.6
112779,9231927.4
124851,9228982.699999999
158488,9227216.4
83328,9224792.199999999
136797,9222927.1
141730,9216370.699999999
87304,9215695.5
156004,9215557.9
140740,9215329.199999999
100648,9212185.1
174774,9211718
37644,9211578.6
48807,9209496.199999999
95940,9207948.4
141586,9206699.199999999
147248,9205655
61372,9205228.800000001
52970,9204416
26430,9203710.5
28504,9201669.199999999
25810,9198878.5
125329,9198688.5
167867,9194022.699999999
134767,9191444.699999999
127745,9191271.6
69208,9187110
155222,9186469.199999999
196916,9182995.800000001
195590,9176353.1
169155,9175176.1
81558,9171946.5
185136,9171293
114790,9168509.1
194142,9165836.6
167639,9161165
11241,9160789.5
82628,9160155.5
41399,9148338
30755,9146196.800000001
6944,9143574.6
6326,9138803.199999999
101296,9135657.6
181479,9121093.300000001
76898,9120983.1
64274,9118745.300000001
175826,9117388
142215,9116876.9
103415,9113128.6
119765,9110768.800000001
107624,9108837.5
84215,9105257.4
73774,9102651.9
173972,9102069
69817,9095513.9
86943,9092253
138859,9087719.300000001
162273,9085296.5
175945,9080401.199999999
16836,9075715.4
70224,9075266
139765,9074755.9
30319,9073233.1
3851,9072657.199999999
181271,9070631.5
162184,9068835.800000001
81683,9067258.5
153028,9067010.5
123324,9061871
186481,9058608.300000001
167680,9052908.800000001
165293,9050545.699999999
122148,9046298.199999999
138604,9045840.800000001
78851,9044822.6
137280,9042355.300000001
8823,9040855.1
163900,9040848.5
75600,9035392.5
81676,9031999.4
46033,9031460.6
194917,9028500
133936,9026949
33182,9024971.1
34220,9021485.4
20118,9019942.6
178258,9019881.699999999
15560,9017687.300000001
111425,9016198.6
95942,9015585.1
132709,9015240.199999999
39731,9014747
154307,9012571.199999999
23769,9008157.6
93328,9007211.199999999
142826,8998297.4
188792,8996014
68703,8994982.199999999
145280,8990941.1
150725,8985686.199999999
172046,8982469.5
70476,8967629.5
124988,8966805.199999999
17937,8963319.800000001
177372,8954873.6
137994,8950916.800000001
84019,8950040
40389,8946158.199999999
69187,8941054.1
4863,8939044.9
50465,8930503.1
43686,8915543.800000001
131352,8909053.6
198916,8906940
135932,8905283
104673,8903682
152308,8903244.1
135298,8900323.199999999
156873,8899429.1
157454,8897339.199999999
75415,8897068.1
46325,8895569.1
1966,8895117.1
24576,8895034.800000001
19425,8890156.6
169735,8890085.6
32225,8889829.300000001
124537,8889770.699999999
146327,8887836.199999999
121562,8887740.4
44731,8882445
93141,8881850.9
187871,8873506.199999999
71709,8873057.300000001
151913,8869321.199999999
33786,8868955.4
35902,8868126.1
23588,8867769.9
24508,8867616
161282,8866661.4
188061,8862304
132847,8862082
166843,8861200.800000001
30609,8860214.699999999
56191,8856547
160740,8852685.4
71229,8846107
91208,8845541.300000001
10995,8845306.6
78094,8839938.300000001
36489,8838538.1
198437,8836494.800000001
151693,8833807.6
185367,8829791.4
65682,8820622.9
65421,8819329.199999999
122225,8816821.9
85330,8811013.199999999
64555,8810643.1
104188,8808211
54411,8805703.4
39438,8805282.6
70795,8800060.9
20383,8799073.300000001
21952,8798624.199999999
63584,8796590
158768,8796423
166588,8796214.4
120600,8793558.1
157202,8788287.9
55358,8786820.800000001
168322,8786670.699999999
25143,8786324.800000001
5368,8786274.1
114025,8786201.1
97744,8785315.9
164327,8784503.9
76542,8782613.300000001
4731,8772846.699999999
157590,8772006.5
154276,8771733.9
28705,8771576.6
100226,8769455
179195,8769185.199999999
184355,8768118.1
120408,8768011.1
63145,8761992
53135,8753491.800000001
173071,8750508.800000001
41087,8749436.800000001
194830,8747438.4
43496,8743359.300000001
30235,8741611
26391,8741399.6
191816,8740258.699999999
47616,8737229.699999999
152101,8734432.800000001
163784,8730514.300000001
5134,8728424.6
155241,8725429.9
188814,8724182.4
140782,8720378.800000001
153141,8719407.5
169373,8718609.1
41335,8714773.800000001
197450,8714617.300000001
87004,8714017.800000001
181804,8712257.800000001
122814,8711119.1
109939,8709193.199999999
98094,8708780
74630,8708040.800000001
197291,8706519.1
184173,8705467.5
192175,8705411.1
19471,8702536.1
18052,8702155.699999999
135560,8698137.699999999
152791,8697325.800000001
170953,8696909.199999999
116137,8696687.199999999
7722,8696589.4
49788,8694846.699999999
13252,8694822.4
12633,8694559.4
193438,8690426.699999999
17326,8689329.199999999
96124,8679794.6
143802,8676626.5
30389,8675826.6
75250,8675257.1
72613,8673524.9
123520,8672456.300000001
325,8667741.300000001
167291,8667556.199999999
150119,8663403.5
88420,8663355.4
179784,8653021.300000001
130884,8651970
172611,8648217
85373,8647796.199999999
122717,8646758.5
113431,8646348.300000001
66015,8643349.4
33141,8643243.199999999
69786,8637396.9
181857,8637393.300000001
122939,8636378
196223,8635391
50532,8632648.199999999
58102,8632614.5
93581,8632372.4
52804,8632109.300000001
755,8627091.699999999
16597,8623357.1
119041,8622397
89050,8621186
98696,8620784.800000001
94399,8620524
151295,8616671
56417,8613450.4
121322,8612948.199999999
126883,8611373.4
29155,8610163.6
114530,8608471.699999999
131007,8607394.800000001
128715,8606833.6
72522,8601480
144061,8595718.699999999
83503,8595034.199999999
112199,8590717.4
9227,8587350.4
116318,8585910.699999999
41248,8585559.6
159398,8584821
105966,8582308.800000001
137876,8580641.300000001
122272,8580400.800000001
195717,8577278.1
165295,8571121.9
5840,8570728.699999999
120860,8570610.4
66692,8567540.5
135596,8563276.300000001
150576,8562794.1
7500,8562393.800000001
107716,8561541.6
100611,8559995.9
171192,8557390.1
107660,8556696.6
13461,8556545.1
90310,8555131.5
141493,8553782.9
71286,8552682
136423,8551300.800000001
54241,8550785.300000001
120325,8549976.6
424,8547527.1
196543,8545907.1
13042,8542717.199999999
58332,8536074.699999999
9191,8535663.9
134357,8535429.9
96207,8534900.6
92292,8530618.800000001
181093,8528303.5
105064,8527491.6
59635,8526854.1
136974,8524351.6
126694,8522783.4
6247,8522606.9
139447,8522521.9
96313,8520949.9
108454,8520916.300000001
181254,8519496.1
71117,8519223
131703,8517215.300000001
59312,8510568.4
2903,8509960.4
102838,8509527.699999999
162806,8508906.1
41527,8508222.4
118416,8505858.4
180203,8505024.199999999
14773,8500598.300000001
140446,8499514.199999999
199641,8497362.6
109240,8494617.1
150268,8494188.4
45310,8492380.699999999
36552,8490733.6
199690,8490145.800000001
185353,8488726.699999999
163615,8484985
196520,8483545
133438,8483482.4
77285,8481442.300000001
55824,8476893.9
76753,8475522.1
46129,8472718
28358,8472515.5
9317,8472145.300000001
33823,8469721.4
39055,8469145.1
91471,8468874.6
142299,8466039.5
97672,8464119.800000001
134712,8461781.800000001
157988,8460123.199999999
102284,8458652.4
73533,8458453.300000001
90599,8457874.9
112160,8457863.4
124792,8457633.699999999
66097,8457573.199999999
165271,8456969
146925,8454887.9
164277,8454838.5
131290,8454811.199999999
179386,8450909.9
90486,8447873.9
175924,8444421.699999999
185922,8442394.9
38492,8436438.300000001
172511,8436287.300000001
139539,8434180.300000001
11926,8433199.5
55889,8431449.9
163068,8431116.4
138772,8428406.4
126821,8425180.699999999
22091,8420687.9
55981,8419434.4
100960,8419403.5
172568,8417955.199999999
63135,8415945.5
137651,8413170.4
191353,8413039.800000001
62988,8411571.5
103417,8411541.1
12052,8411519.300000001
104260,8408516.6
157129,8405730.1
77254,8405537.199999999
112966,8403512.9
168114,8402764.6
49940,8402328.199999999
52017,8398753.6
176179,8398087
100215,8395906.6
61256,8392811.199999999
15366,8388907.800000001
109479,8388027.2
66202,8386522.8
81707,8385761.2
51727,8385426.4
9980,8382754.6
174403,8378575.7
54558,8378041.9
3141,8377378.2
134829,8377105.5
145056,8376920.8
194020,8375157.6
7117,8373982.3
120146,8373796.2
126843,8370761.3
62117,8369493.4
111221,8367525.8
159337,8366092.3
173903,8365428.5
136438,8364065.5
56684,8363198
137597,8363185.9
20039,8361138.2
121326,8359635.5
48435,8352863.1
1712,8349107
167190,8347238.7
32113,8346452
40580,8342983.3
74785,8342519.1
14799,8342236.8
177291,8341736.8
198956,8340370.7
69179,8338466
118764,8337616.6
128814,8336435.6
82729,8331766.9
152048,8330639
171085,8326259.5
126730,8325974.4
77525,8323282.5
170653,8322840.5
5257,8320350.8
67350,8318987.6
109008,8317836.5
199043,8316603.5
139969,8316551.5
22634,8316531.2
173309,8315750.3
10887,8315019.4
42392,8312896
126040,8312623.2
101590,8304555.4
46891,8302192.1
138721,8301745.6
113715,8301533.2
78778,8299685.6
142908,8299447.8
64419,8297631.8
21396,8296272.3
4180,8295646.9
63534,8295383.7
135957,8294389.9
30126,8291920.3
158427,8288938
14545,8288395.9
75548,8288287.2
64473,8286137.4
149553,8285714.9
151284,8283526.7
171091,8282934.4
194256,8278985.3
952,8276136
121541,8275390.3
177664,8275315.2
51117,8274504.3
66770,8273407.8
37238,8272728.1
46679,8270486.6
165852,8268312.6
99458,8266564.5
114519,8265493.5
7231,8264881.5
19033,8264826.6
125123,8262732.7
18642,8261579
50386,8261380.1
193770,8259578.8
7276,8258101.6
178045,8253904.2
49033,8253696.2
187195,8251334.6
10590,8249227.4
143779,8247057.7
35205,8245675.2
19729,8245081.6
144946,8240479.8
123786,8239581.2
70843,8237973.2
112437,8236907.5
5436,8236039.6
163754,8235471.2
115945,8234811.4
27918,8233957.9
105712,8233571.9
41007,8229431.8
40476,8226640.4
145620,8221371.6
7771,8220413.3
86424,8215572.6
129137,8215478.4
76020,8210495.4
140213,8209831.8
32379,8208338.9
130616,8207715.8
195469,8206609.8
191805,8205147.8
90906,8200951.2
170910,8195558
105399,8193122.6
123798,8192386
90218,8191689.2
114766,8189339.5
11289,8187354.7
178308,8185750.5
71271,8185519.2
1115,8184903.4
152636,8184530.7
151619,8182909.1
116943,8181072.7
28891,8181051.5
47049,8180955
158827,8180470.9
92620,8179671.6
20814,8176953.5
179323,8176795.6
193453,8174343.9
56888,8173342
28087,8169876.3
164254,8169632.4
57661,8168848.2
7363,8167538.1
164499,8167512.1
197557,8165940.5
5495,8164805.2
966,8163824.8
98435,8161771.5
127227,8161344.9
194100,8160978.8
40134,8160358.1
107341,8159952.1
6790,8158792.7
43851,8157101.4
51295,8156419.2
69512,8151537
164274,8149869.9
130854,8145338.9
186865,8143586.8
176629,8141411.2
193739,8141377.8
6810,8139822.6
27732,8136725
50616,8134089.8
123908,8128920.5
140994,8128470.8
99039,8128290.8
62735,8124940.5
47829,8122796.5
192635,8122687.6
192429,8119268
145812,8119165.6
42896,8118529.8
146877,8118266.2
60882,8116095
18254,8114783
165464,8114571.8
57936,8111927.3
52226,8110723.3
128571,8106788.8
100308,8105837
8872,8102395.6
58867,8102033.2
145153,8100222.8
172088,8098138.2
59398,8095845.5
89395,8093576.1
171961,8093538
88736,8090762.2
174053,8090350.1
102237,8089103.2
43041,8086537.9
110219,8085296.9
126738,8084199.2
44787,8083628.4
31277,8083580.8
93595,8082188.8
189040,8080257.2
59851,8079024.2
175100,8077904
43429,8076730
154199,8074940.8
60963,8073894.4
8768,8072761
66095,8071421.7
111552,8068184.5
24563,8067500.4
16167,8067495.2
12662,8067248.9
94540,8063727.2
23308,8063463.2
27390,8062823.3
130660,8062787.5
8608,8062411.2
181552,8062008.3
199319,8060248.6
55475,8058850.9
142711,8057926.6
103499,8056978
105943,8056698.8
8432,8053052.2
149392,8049675.7
101248,8048855.5
140962,8047260.7
87101,8046651.8
133107,8046476.7
45126,8045924.4
87508,8042966.4
124711,8042722.7
173169,8042224.4
175161,8041332
167787,8040075.8
3242,8038855.5
114789,8038628.4
43833,8038545.8
141198,8035110.7
137248,8034109.4
96673,8033491.2
32180,8032380.7
166493,8031902.4
66959,8031839.4
85628,8029693.4
110971,8029469.7
130395,8027463.9
7757,8026840.4
178446,8025379.1
41295,8024785.5
100956,8024179.3
131917,8021604.8
24224,8020463.5
2073,8020009.6
121622,8018462.2
14357,8016906.3
135601,8016209.4
58458,8016192.5
73036,8015799
184722,8015680.3
151664,8014822
195090,8012680.2
162609,8011241
83532,8009753.9
50166,8007137.9
181562,8006806
175165,8005319.8
62500,8005316.3
36342,8004333.4
128435,8004242.9
92516,8003836.8
30802,8003710.9
107418,8000430.3
46620,7999778.4
191803,7994734.2
106343,7993087.8
59362,7990397.5
8329,7990052.9
75133,7988244
179023,7986829.6
135899,7985726.6
5824,7985340
148579,7984889.6
95888,7984735.7
9791,7982699.8
170437,7982370.7
39782,7977858.2
20605,7977556
28682,7976960
42172,7973399
56137,7971405.4
64729,7970769.7
98643,7968603.7
153787,7967535.6
8932,7967222.2
20134,7965713.3
197635,7963507.6
80408,7963312.2
37728,7961875.7
26624,7961772.3
44736,7961144.1
29763,7960605
36147,7959463.7
146040,7957587.7
115469,7957485.1
142276,7956790.6
181280,7954037.4
115096,7953047.6
109650,7952258.7
93862,7951992.2
158325,7950728.3
55952,7950387.1
122397,7947106.3
28114,7946945.7
11966,7945197.5
47814,7944083
85096,7943691.1
51657,7943593.8
196680,7943578.9
13141,7942730.3
193327,7941036.3
152612,7940663.7
139680,7939242.4
31134,7938318.3
45636,7937240.9
56694,7936016
8114,7933921.9
71518,7932261.7
72922,7930400.6
146699,7929167.4
92387,7928972.7
186289,7928786.2
95952,7927972.8
196514,7927180.7
4403,7925729
2267,7925649.4
45924,7925047.7
11493,7916722.2
104478,7916253.6
166794,7913842
161995,7910874.3
23538,7909752.1
41093,7909579.9
112073,7908617.6
92814,7908262.5
88919,7907992.5
79753,7907933.9
108765,7905339
146530,7905336.6
71475,7903367.6
36289,7901946.5
61739,7900794
52338,7898638.1
194299,7898421.2
105235,7897829.9
77207,7897752.7
96712,7897575.3
10157,7897046.3
171154,7896814.5
79373,7896186
113808,7893353.9
27901,7892952
128820,7892882.7
25891,7890511.2
122819,7888881
154731,7888301.3
101674,7879324.6
51968,7879102.2
72073,7877736.1
5182,7874521.7
---- TYPES
BIGINT, DOUBLE
====
